@import play.api.libs.json.{ Json, JsObject }
@import uk.gov.hmrc.hmrcemailrenderer.templates.pillar2.Pillar2DateTimes.*

@(params: Map[String, Any])

@errorList = @{
  params("errors") match {
    case errors: String => Json.parse(errors).as[List[JsObject]]
    case errors: Seq[_] => errors.asInstanceOf[Seq[Map[String, String]]].map(m => Json.toJson(m).as[JsObject])
    case _ => List()
  }
}

Critical schema or business rule failure - GloBE Information Return (GIR)

Pillar 2 ID: @{params("pillar2Id")}

GIR Reference ID: @{params("referenceId")}

Received: @{toTwelveHourUserFacing(params("submissionTime").toString)} on @{ukAllNumericDateToUserFacing(params("submissionDate").toString)}

Your GIR has not been processed because it failed one of the following business rules:

- GIR HMRC 1: Failed threat scan – the file contains prohibited characters or invalid entity references
- 50007: Failed Schema Validation – the file failed validation against the OECD GIR XML Schema
- 50009: Test data – the file has 'DocTypeIndic' values in the range OECD10-OECD13
- GIR HMRC 2: Following whitespace collapse, the referenced file failed validation against the GIR XML Schema

What you need to do next

You must correct these errors and re-submit your return before your submission deadline date.

You may be charged penalties if you submit a return after your deadline date.

You should contact your software provider if you need further guidance on how to correct these errors.

Thank you.

HM Revenue and Customs
Customer Compliance Group

CRITICAL ERRORS IDENTIFIED:
@for(error <- errorList) {
Error Code: @{(error \ "errorCode").as[String]}
Business Rule Name: @{(error \ "businessRuleName").as[String]}
Error Level: @{(error \ "errorLevel").as[String]}
Description: @{(error \ "description").as[String]}
---
}

@{uk.gov.hmrc.hmrcemailrenderer.templates.helpers.txt.template_footer()}
